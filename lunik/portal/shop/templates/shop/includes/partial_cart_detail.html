{% load thumbnail %}
{% load tags %}
{% load humanize %}

{% if cart %}


				<!-- Header Icon -->
				<div class="header-icons">
          {% if request.user.is_authenticated and request.user.is_customer %}
          <div class="wrap_menu ">
            <nav class="menu">
              <ul class="main_menu">
                <li>
                  <a style="font-family: Montserrat-Bold;font-size: 15px;color: #222222;line-height: 1.5;text-transform: uppercase;" href="{% url 'dashboard:profile'%}">Hola, {{request.user.first_name}}</a>
                  <ul class="sub_menu">
                    <li><a href="{% url 'dashboard:orders' %}">Mis compras</a></li>
                    <li><a href="{% url 'dashboard:address' %}">Mis direcciones</a></li>
                    <li><a href="{% url 'dashboard:password_edit' %}">Cambiar contraseña</a></li>
                    <li><a href="{% url 'authorization:logout' %}">Cerrar sesión</a></li>
                  </ul>
                </li>
              </ul>
            </nav>
          </div>
          <a href="#" class="header-wrapicon1 dis-block">
            {% if request.user.avatar %}
            <img src="{{request.user.avatar.url}}" class="header-icon1" alt="ICON">
            {% else %}
						<img src="{{STATIC_URL}}site/images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
            {% endif %}
          </a>
          {% else %}

            <span class="linedivide1"></span>
            <a href="" class="flex-c-m size2 bo-rad-13 s-text2 bgwhite hov1 trans-0-4">
              Ingresar
            </a>
            <span class="linedivide1"></span>
            <a href="" class="flex-c-m size2 bo-rad-13 s-text2 bgwhite hov1 trans-0-4">
              Registrarse
            </a>

          {% endif  %}
					<span class="linedivide1"></span>
          <div class="search-box-container">
            <form action="{% url 'shop:search' %}" method="POST">
              {% csrf_token %}
              <div id="search-box" class="input-group input-group-sm search-box">
                <span class="input-group-addon close" onclick="openSearchBox()"><i class="fa fa-times" aria-hidden="true"></i></span>
                <input type="text" class="form-control" name="q" placeholder="Buscar productos" aria-describedby="sizing-addon3">
                <span class="input-group-btn">
                  <button class="btn btn btn-secondary" type="button">
                    <i class="fa fa-search" aria-hidden="true"></i>
                  </button>
                </span>
              </div>
            </form>
              <button class="btn btn-default btn-search-box" onclick="openSearchBox()">
                <i class="fa fa-search" aria-hidden="true"></i>
              </button>

          </div>
					<span class="linedivide1"></span>

					<div class="header-wrapicon2 spaced">
						<img src="{{STATIC_URL}}site/images/icons/icon-header-02.png" class="header-icon1 js-show-header-dropdown" alt="ICON">
						<span class="header-icons-noti">{{cart.get_quantity_products}}</span>

						<!-- Header cart noti -->
						<div class="header-cart header-dropdown">
							<ul class="header-cart-wrapitem">
                {% for item in cart %}
                {% if forloop.counter <= 3 %}
                {% for key in item.variants.keys %}
								<li class="header-cart-item">
									<div class="header-cart-item-img remove-cart-item" data-url="{% if request.is_secure %}https://{% else %}http://{% endif %}{{request.get_host}}{% url 'shop:cart_remove' %}"
                  data-product="{{item.product.pk}}" data-size="{{key|get_sizes_cart:item}}"
                  data-checkout="0">
                    {% with image=item.product.product.products_gallery.all.first.image %}
                    {% thumbnail image '92x92' crop='center' as img %}
                    <img src="{{img.url}}" alt="IMG">
                    {% endthumbnail %}
                    {% endwith %}
									</div>

									<div class="header-cart-item-txt">
										<a href="#" class="header-cart-item-name">
											{{item.product.product}}
										</a>

										<span class="header-cart-item-info">
                      {% if item.product.is_sale %}
                      {{key|get_quantity_cart:item}} x ${{item.product.sale_price}}
                      {% else %}
                      {{key|get_quantity_cart:item}} x ${{item.product.price}}
                      {% endif %}
										</span>
									</div>
                </li>
                {% endfor %}
                {% endif %}
                {% endfor %}
							</ul>
							<!-- <div class="header-cart-total" style="padding-bottom: 0px; !important">
								Envio: ${{cart.get_shipping_cost|intcomma}}
							</div> -->
              {% if cart.get_quantity_products > 0 %}
							<div class="header-cart-total" style="padding-bottom: 0px; !important">
              {% if cart.get_shipping_cost > 0 %}
								Envío: ${{cart.get_shipping_cost|intcomma}}
              {% else %}
                ¡Envío Gratis! <i class="fa fa-bolt" style="color:{{store_instance.store_meta.header_color}}"></i>
              {% endif %}
							</div>
							<div class="header-cart-total">
								Total: ${{cart.get_total_products|intcomma}}
							</div>

							<div class="header-cart-buttons">
								<div class="header-cart-wrapbtn">
									<!-- Button -->
									<a href="{% if request.is_secure %}https://{% else %}http://{% endif %}{{request.get_host}}{% url 'shop:cart_checkout' %}" class="flex-c-m size1 bg1 bo-rad-20 hov1 s-text1 trans-0-4">
										Ver carrito
									</a>
								</div>
                {% else %}
                <div class="header-cart-total" style="padding-bottom: 0px; !important">
                  Tu carrito está vacío
                  <br>
                  <span class="s-text17">
                    ¡Los productos te esperan!
                  </span>
                  </div>
                <div class="header-cart-buttons" style="float:right;">
                  <div class="header-cart-wrapbtn">
                    <!-- Button -->
                    <a href="{% url 'shop:products_list' %}" class="flex-c-m size10 mt-4 bg1 bo-rad-20 hov1 s-text21 trans-0-4">
                      Empieza a comprar
                    </a>
                  </div>
                {% endif %}
								<!-- <div class="header-cart-wrapbtn"> -->
									<!-- Button -->
									<!-- <a href="{% if request.is_secure %}https://{% else %}http://{% endif %}{{request.get_host}}{% url 'shop:cart_checkout' %}" class="flex-c-m size1 bg1 bo-rad-20 hov1 s-text1 trans-0-4">
										Pagar
									</a>
								</div> -->
							</div>
						</div>
					</div>

				</div>



  {% else %}
  				<!-- Header Icon -->
          <div class="header-icons">
            {% if request.user.is_authenticated %}
            <a href="#" class="header-wrapicon1 dis-block">
              <img src="{{STATIC_URL}}site/images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
            </a>
            {% else %}
            <a href="{% url 'authorization:login' %}" class="flex-c-m size2 bo-rad-13 s-text2 bgwhite hov1 trans-0-4">
              Ingresar
            </a>
            {% endif  %}
            <span class="linedivide1"></span>

            <div class="header-wrapicon2">
              <img src="{{STATIC_URL}}site/images/icons/icon-header-02.png" class="header-icon1 js-show-header-dropdown" alt="ICON">
              <span class="header-icons-noti">0</span>

              <!-- Header cart noti -->
              <div class="header-cart header-dropdown">

                <div class="header-cart-total">
                  Tu carrito esta vacio
                </div>

                <div class="header-cart-buttons">
                  <div class="header-cart-wrapbtn">
                    <!-- Button -->
                    <a class="flex-c-m size1 bg1 bo-rad-20 hov1 s-text1 trans-0-4">
                      Sigue comprando
                    </a>
                  </div>

                </div>
              </div>
            </div>
          </div>
  {% endif %}

  <!--
<button type="button" class="btn btn-link pull-right">
  <span aria-hidden="true" data-icon="&#xe006;"></span> {{cart.get_quantity_products}}:
  ${{cart.get_total_products|intcomma}} <b class="caret"></b>
</button>
<div role="complementary">
  {% for item in cart %}
  {% if forloop.counter <= 2 %}
  {% for key in item.variants.keys %} -->
  <!-- SHOP SUMMARY ITEM -->
  <!-- <article class="shop-summary-item">
    {% with image=item.product.image %}
    {% thumbnail image '92x92' crop='center' as img %}
    <img src="{{img.url}}">
    {% endthumbnail %}
    {% endwith %}
    <div class="item-info-name-features-price">
      <h4><a href="#">{{item.product.product.product.name}}</a></h4>
      <span class="features">Talla: {{key|get_sizes_cart:item}}</span><br>
      <span class="quantity">{{key|get_quantity_cart:item}}</span><b>&times;</b><span class="price">$
        {{key|get_total_cart:item|intcomma}}</span>
    </div>
    <button type="button" class="remove-cart-item"
      data-url="{% if request.is_secure %}https://{% else %}http://{% endif %}{{request.get_host}}{% url 'shop:cart_remove' %}"
      data-product="{{item.product.pk}}" data-size="{{key|get_sizes_cart:item}}" data-checkout="0"><span
        aria-hidden="true" data-icon="&#xe005;"></span></button>
  </article> -->
  <!-- !SHOP SUMMARY ITEM -->
  <!-- {% endfor %}
  {% endif %}
  {% endfor %}
  <hr>
  <div class="flex" style="display: flex; flex-direction: column;width: 100%;">
    <div class="item" style="display: flex;width: 100%;justify-content: space-between;">
      <span class="total-price-tag pull-left" style="margin-bottom: 0rem;">Subtotal</span>
      <span class="total-price pull-right" style="margin-bottom: 0rem;">$ {{cart.get_total_products|intcomma}}</span>
    </div>
    <div class="item" style="display: flex;width: 100%;justify-content: space-between;">
      <span class="total-price-tag pull-left">Total</span>
      <span class="total-price pull-right">$ {{cart.get_total_products|intcomma}}</span>
    </div>
  </div>
  <div class="clearfix"></div>
  {% if cart.get_quantity_products > 0 %}
  <a href="{% if request.is_secure %}https://{% else %}http://{% endif %}{{request.get_host}}{% url 'shop:cart_checkout' %}"
    class="btn btn-default btn-block">
    Checkout
  </a>
  {% endif %}
</div> -->


<script>

function openSearchBox(){
  $('#search-box').toggleClass('show')
}

</script>
